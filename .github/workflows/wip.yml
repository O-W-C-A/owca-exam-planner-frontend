name: WIP Status

on:
  pull_request:
    types: [opened, edited, synchronize, labeled, unlabeled]

jobs:
  wip:
    runs-on: ubuntu-latest

    steps:
      # Step 1: Fail if PR title contains "WIP" or "Work in Progress"
      - name: Check PR title
        run: |
          if [[ "${{ github.event.pull_request.title }}" =~ (WIP|Work[[:space:]]in[[:space:]]Progress) ]]; then
            echo "PR title contains 'WIP' or 'Work in Progress'. Failing the workflow."
            exit 1
          else
            echo "PR title is valid."
          fi
      # Step 2: Fail if PR has the 'wip' label using jq
      - name: Check for WIP label
        id: check_wip
        run: |
          # Get the labels from the pull request as a JSON array
          labels="${{ toJson(github.event.pull_request.labels) }}"

          # Check if 'wip' label is present
          if echo "$labels" | grep -q 'name: wip'; then
            echo "WIP label found. Failing the job."
            exit 1
          else
            echo "No WIP label found. Continuing."
          fi
